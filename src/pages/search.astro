---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Search | SqualieC" description="Static full-text search powered by Pagefind.">
  <section class="hero hero-surface">
    <p class="eyebrow">Search</p>
    <h1>Find any project or post fast.</h1>
    <p class="lead">Full-text search across all projects and posts, generated at build time.</p>
  </section>

  <section class="projects-list">
    <div class="search-shell">
      <div id="search"></div>
      <p id="search-status" style="display:none"></p>
    </div>
  </section>
</Layout>

<script>
  async function mountSearch() {
    const status = document.getElementById('search-status');

    try {
      const pagefindUiPath = '/pagefind/pagefind-ui.js';
      await import(/* @vite-ignore */ pagefindUiPath);
      // @ts-ignore
      new window.PagefindUI({
        element: '#search',
        showSubResults: true,
        resetStyles: false
      });
    } catch {
      if (status) {
        status.style.display = 'block';
        status.style.color = 'var(--muted)';
        status.style.fontSize = '0.9rem';
        status.style.marginTop = '0.75rem';
        status.textContent = 'Search index not built yet. Run npm run build:search to enable search.';
      }
    }
  }

  mountSearch();
</script>


